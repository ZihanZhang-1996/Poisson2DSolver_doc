
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Zihan Zhang">
      
      
      
        <link rel="prev" href="../..">
      
      
        <link rel="next" href="../../input/">
      
      
      <link rel="icon" href="../../assets/logo2.jpg">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.28">
    
    
      
        <title>数学推导 - 二维非线性柏松方程-ZZ</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-9XN0RGHSE1"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-9XN0RGHSE1",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-9XN0RGHSE1",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>var consent;"undefined"==typeof __md_analytics||(consent=__md_get("__consent"))&&consent.analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#c" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="二维非线性柏松方程-ZZ" class="md-header__button md-logo" aria-label="二维非线性柏松方程-ZZ" data-md-component="logo">
      
  <img src="../../assets/logo2.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            二维非线性柏松方程-ZZ
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              数学推导
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="red" data-md-color-accent="red"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  首页

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  数学推导

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../input/" class="md-tabs__link">
        
  
    
  
  输入文件

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../Q1/" class="md-tabs__link">
        
  
    
  
  解析解和数值解的比较

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../Q2/" class="md-tabs__link">
        
  
    
  
  稀疏和稠密矩阵的比较

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../ctest/" class="md-tabs__link">
        
  
    
  
  单元测试

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../graph/" class="md-tabs__link">
        
  
    
  
  程序流程图

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../install/" class="md-tabs__link">
        
  
    
  
  安装说明

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="二维非线性柏松方程-ZZ" class="md-nav__button md-logo" aria-label="二维非线性柏松方程-ZZ" data-md-component="logo">
      
  <img src="../../assets/logo2.jpg" alt="logo">

    </a>
    二维非线性柏松方程-ZZ
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    首页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    数学推导
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    数学推导
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 数学背景
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 数学背景">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 符号说明
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 泊松方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 弱形式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-galerkin" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Galerkin 方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 牛顿迭代法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 单元项的计算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 单元项的计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 形函数与梯度
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 坐标变换与雅可比矩阵
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 数值积分（高斯积分）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 组装单元矩阵与向量
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 单元叠加到全局系统的算法说明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 单元叠加到全局系统的算法说明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 节点编号映射
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 全局矩阵与向量更新
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 狄利克雷边界条件的施加
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 狄利克雷边界条件的施加">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 修改全局矩阵和残差
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 程序实现逻辑
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../input/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    输入文件
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Q1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    解析解和数值解的比较
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Q2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    稀疏和稠密矩阵的比较
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ctest/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    单元测试
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    程序流程图
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    安装说明
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      1. 数学背景
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. 数学背景">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 符号说明
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 泊松方程
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 弱形式
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-galerkin" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Galerkin 方法
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 牛顿迭代法
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      2. 单元项的计算
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2. 单元项的计算">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      2.1 形函数与梯度
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22" class="md-nav__link">
    <span class="md-ellipsis">
      2.2 坐标变换与雅可比矩阵
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      2.3 数值积分（高斯积分）
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      2.4 组装单元矩阵与向量
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    <span class="md-ellipsis">
      3. 单元叠加到全局系统的算法说明
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. 单元叠加到全局系统的算法说明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 节点编号映射
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 全局矩阵与向量更新
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    <span class="md-ellipsis">
      4. 狄利克雷边界条件的施加
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. 狄利克雷边界条件的施加">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 修改全局矩阵和残差
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 程序实现逻辑
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
                  


<h1 id="c">C++ 泊松方程求解器<a class="headerlink" href="#c" title="Permanent link">¶</a></h1>
<h2 id="1">1. 数学背景<a class="headerlink" href="#1" title="Permanent link">¶</a></h2>
<p>本节展示泊松方程的数学形式，包括弱形式、离散化以及牛顿迭代方法。</p>
<hr />
<h3 id="11">1.1 符号说明<a class="headerlink" href="#11" title="Permanent link">¶</a></h3>
<table>
<thead>
<tr>
<th>类型</th>
<th>字体格式</th>
<th>示例</th>
</tr>
</thead>
<tbody>
<tr>
<td>函数 / 参数 / 下标</td>
<td>小写字母</td>
<td><span class="arithmatex">\(a\)</span></td>
</tr>
<tr>
<td>矩阵</td>
<td>花体字母</td>
<td><span class="arithmatex">\(\mathcal{A}\)</span></td>
</tr>
<tr>
<td>矩阵/向量的元素</td>
<td>带下标的字母</td>
<td><span class="arithmatex">\(a_i\)</span>, <span class="arithmatex">\(A_{ij}\)</span></td>
</tr>
<tr>
<td>向量</td>
<td>大写粗体字母</td>
<td><span class="arithmatex">\(\mathbf{A}\)</span></td>
</tr>
</tbody>
</table>
<hr />
<h3 id="12">1.2 泊松方程<a class="headerlink" href="#12" title="Permanent link">¶</a></h3>
<p>泊松方程的一般形式为：</p>
<div class="arithmatex">\[
\nabla\cdot(\nabla u)=f,\quad \text{在}\quad \Omega,
\]</div>
<p>其中 <span class="arithmatex">\(u\)</span> 和 <span class="arithmatex">\(f\)</span> 是定义在流形 <span class="arithmatex">\(\Omega\)</span> 上的函数。</p>
<hr />
<h3 id="13">1.3 弱形式<a class="headerlink" href="#13" title="Permanent link">¶</a></h3>
<p>强形式要求 <span class="arithmatex">\(u\)</span> 在区域 <span class="arithmatex">\(\Omega\)</span> 内逐点满足 PDE。<br />
在数值 PDE 中，通常采用弱形式来放宽对解的光滑性要求：</p>
<div class="arithmatex">\[
\int_\Omega \nabla\cdot(\nabla u)\,\nu \, d\Omega = \int_\Omega f\nu \, d\Omega,
\]</div>
<p>其中 <span class="arithmatex">\(\nu\)</span> 是测试函数，要求 <span class="arithmatex">\(\nu\)</span> 及 <span class="arithmatex">\(\nabla \nu\)</span> 在 <span class="arithmatex">\(\Omega\)</span> 上平方可积。</p>
<p>通过分部积分，弱形式变为：</p>
<div class="arithmatex">\[
-\int_\Omega \nabla\nu \cdot \nabla u \, d\Omega + \int_{\partial\Omega} (n\cdot \nabla u)\nu \, dS = \int_\Omega f\nu \, d\Omega.
\]</div>
<p>若测试函数 <span class="arithmatex">\(\nu\)</span> 在边界 <span class="arithmatex">\(\partial \Omega\)</span> 上为零，则边界项消失，得到：</p>
<div class="arithmatex">\[
-\int_\Omega \nabla\nu \cdot \nabla u \, d\Omega = \int_\Omega f\nu \, d\Omega,\quad \nu=0 \;\;\text{在}\;\;\partial\Omega.
\]</div>
<hr />
<h3 id="14-galerkin">1.4 Galerkin 方法<a class="headerlink" href="#14-galerkin" title="Permanent link">¶</a></h3>
<p>弱形式要求积分对 Hilbert 空间 <span class="arithmatex">\(V\)</span> 中任意测试函数成立。但 <span class="arithmatex">\(V\)</span> 是无限维的。<br />
Galerkin 方法选择一个有限维子空间 <span class="arithmatex">\(V_n \subset V\)</span>，使测试函数落在其中。弱形式写作：</p>
<div class="arithmatex">\[
\text{寻找}\; U_n\in V_n,\;\; \text{使得}\;\forall\nu\in V_n:\;\;
-\int_\Omega \nabla\nu \cdot \nabla U_n \, d\Omega = \int_\Omega f\nu \, d\Omega
\]</div>
<p>设 <span class="arithmatex">\(\{e_1, e_2, ..., e_n\}\)</span> 是 <span class="arithmatex">\(V_n\)</span> 的一组基函数，问题可写成：</p>
<div class="arithmatex">\[
\forall i\in [1,2,...,n],\quad -\int_\Omega \nabla e_i \cdot \nabla U_n \, d\Omega = \int_\Omega f e_i \, d\Omega
\]</div>
<p>将 <span class="arithmatex">\(U_n\)</span> 展开为：</p>
<div class="arithmatex">\[
U_n=\sum_i u_i e_i
\]</div>
<p>代入后得到矩阵形式：</p>
<div class="arithmatex">\[
\mathcal{A}U=\mathcal{F}
\]</div>
<p>其中：</p>
<div class="arithmatex">\[
\mathcal{A}=\left(
    \begin{matrix}
A_{11} &amp; A_{12} &amp; ... &amp; A_{1n} \\
&amp;  &amp; ... &amp; \\
A_{n1} &amp; A_{n2} &amp; ... &amp; A_{nn}
\end{matrix}
\right),\quad A_{ij}=- \int_\Omega \nabla e_i \cdot \nabla e_j \, d\Omega
\]</div>
<div class="arithmatex">\[
U=[u_1,u_2,...,u_n]^T
\]</div>
<div class="arithmatex">\[
f=[f_1,f_2,..,f_n]^T,\quad f_i=\int_\Omega f e_i \, d\Omega
\]</div>
<hr />
<h3 id="15">1.5 牛顿迭代法<a class="headerlink" href="#15" title="Permanent link">¶</a></h3>
<p>牛顿法用于求解非线性 PDE（即 <span class="arithmatex">\(f\)</span> 与 <span class="arithmatex">\(u\)</span> 有关）。  </p>
<p>残差向量 <span class="arithmatex">\(\mathbf{R}\)</span> 定义为：</p>
<div class="arithmatex">\[
R_i=-\sum_j u_j \int_\Omega \nabla e_i \cdot \nabla e_j \, d\Omega - \int_\Omega f e_i \, d\Omega,
\]</div>
<p>雅可比矩阵 <span class="arithmatex">\(\mathcal{K}\)</span> 定义为：</p>
<div class="arithmatex">\[
K_{ij}=\frac{\partial R_i}{\partial u_j}=-\int_\Omega \nabla e_i \cdot \nabla e_j \, d\Omega - \int_\Omega f'(u) e_i e_j \, d\Omega.
\]</div>
<p>牛顿迭代步骤为：</p>
<div class="arithmatex">\[
U_{n+1}=U_n - \frac{R(u)}{R'(u)}
\]</div>
<p>矩阵形式为：</p>
<div class="arithmatex">\[
\mathcal{K}\,\delta \mathbf{U} = -\mathbf{R}.
\]</div>
<p>原文档中，1.5和1.6的形式为：</p>
<figure style="border: 2px solid black; padding: 8px; display: inline-block;">
  <img src="/assets/Doc_0.jpeg" width=600px;>
  <figcaption>Fig 1. 原文档中的1.5和1.6式</figcaption>
</figure>

<p>如果将基函数替换为形函数，可以看出<span class="arithmatex">\(\mathcal{K}\)</span>变为有限元的单元刚度矩阵<span class="arithmatex">\(k^{(e)}\)</span>；<span class="arithmatex">\(-\mathbf{R}\)</span>变为有限元的荷载向量<span class="arithmatex">\(f^{(e)}\)</span>。</p>
<h2 id="2">2. 单元项的计算<a class="headerlink" href="#2" title="Permanent link">¶</a></h2>
<h3 id="21">2.1 形函数与梯度<a class="headerlink" href="#21" title="Permanent link">¶</a></h3>
<p>在参考单元 <span class="arithmatex">\((\xi, \eta)\)</span> 上定义形函数：</p>
<ul>
<li>三角形单元：线性形函数</li>
</ul>
<div class="arithmatex">\[
N_1 = 1 - \xi - \eta,\quad N_2 = \xi,\quad N_3 = \eta
\]</div>
<ul>
<li>四边形单元：双线性形函数</li>
</ul>
<div class="arithmatex">\[
N_1 = \tfrac{1}{4}(1-\xi)(1-\eta),\quad N_2 = \tfrac{1}{4}(1+\xi)(1-\eta),\dots
\]</div>
<p>同时计算其对局部坐标的导数 <span class="arithmatex">\(\partial N_i / \partial \xi, \partial N_i / \partial \eta\)</span>。</p>
<h3 id="22">2.2 坐标变换与雅可比矩阵<a class="headerlink" href="#22" title="Permanent link">¶</a></h3>
<p>通过雅可比矩阵 <span class="arithmatex">\(\mathcal{K}\)</span> 将参考单元积分变换到物理单元：</p>
<div class="arithmatex">\[
\nabla N_i = \mathcal{K}^{-1} \begin{bmatrix} \partial N_i / \partial \xi \\ \partial N_i / \partial \eta \end{bmatrix},
\qquad d\Omega = \det(\mathcal{K}) \, d\xi d\eta
\]</div>
<h3 id="23">2.3 数值积分（高斯积分）<a class="headerlink" href="#23" title="Permanent link">¶</a></h3>
<p>将积分离散为高斯点求和，例如三阶高斯积分：</p>
<div class="arithmatex">\[
\int_{\Omega_e} g(x,y) \, d\Omega \;\;\approx\;\; \sum_{q=1}^{n_q} g(x_q, y_q) \, w_q \, |\det(\mathcal{K})|
\]</div>
<p>其中 <span class="arithmatex">\((x_q,y_q)\)</span> 为积分点坐标，<span class="arithmatex">\(w_q\)</span> 为权重。</p>
<h3 id="24">2.4 组装单元矩阵与向量<a class="headerlink" href="#24" title="Permanent link">¶</a></h3>
<p>在每个积分点，计算：</p>
<ul>
<li>
<p>插值解 <span class="arithmatex">\(u(x_q,y_q)\)</span>；</p>
</li>
<li>
<p>源项 <span class="arithmatex">\(f(u,x_q,y_q)\)</span>；</p>
</li>
<li>
<p>梯度项 <span class="arithmatex">\(\nabla N_i \cdot \nabla N_j\)</span>；</p>
</li>
<li>
<p>并累加到 <code>Ke</code> 和 <code>Fe</code>。</p>
</li>
</ul>
<p>伪代码示意：</p>
<div class="highlight"><pre><span></span><code><span class="n">Ke</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">grad_phi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="err">·</span><span class="w"> </span><span class="n">grad_phi</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Ni</span><span class="o">*</span><span class="n">Nj</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">dfdu_q</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="p">;</span>
<span class="n">Fe</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w">   </span><span class="o">+=</span><span class="w"> </span><span class="p">(</span><span class="n">grad_phi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="w"> </span><span class="err">·</span><span class="w"> </span><span class="n">grad_uq</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">f_q</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Ni</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">weight</span><span class="p">;</span>
</code></pre></div>
<p>程序对应关系</p>
<table>
<thead>
<tr>
<th>数学符号</th>
<th>程序变量</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="arithmatex">\(k^{(e)}\)</span></td>
<td><code>Ke</code></td>
<td>单元刚度矩阵</td>
</tr>
<tr>
<td><span class="arithmatex">\(f^{(e)}\)</span></td>
<td><code>Fe</code></td>
<td>单元残差/载荷向量</td>
</tr>
<tr>
<td><span class="arithmatex">\(\mathbf{R}\)</span></td>
<td><code>R</code></td>
<td>全局残差向量（由所有 <code>Fe</code> 装配）</td>
</tr>
<tr>
<td><span class="arithmatex">\(\mathcal{K}\)</span></td>
<td><code>K</code></td>
<td>全局雅可比矩阵（由所有 <code>Ke</code> 装配）</td>
</tr>
</tbody>
</table>
<h2 id="3">3. 单元叠加到全局系统的算法说明<a class="headerlink" href="#3" title="Permanent link">¶</a></h2>
<p>单元刚度矩阵 <span class="arithmatex">\(k^{(e)}\)</span> 和单元残差向量 <span class="arithmatex">\(f^{(e)}\)</span> 仅对应一个局部单元。为了得到整体问题的全局方程，需要将所有单元的贡献<strong>装配</strong>到全局雅可比矩阵 <span class="arithmatex">\(K\)</span> 和全局残差向量 <span class="arithmatex">\(R\)</span> 中。  </p>
<h3 id="31">3.1 节点编号映射<a class="headerlink" href="#31" title="Permanent link">¶</a></h3>
<p>每个单元的自由度（节点编号）是局部的，需要通过 <strong>节点全局 ID</strong> 建立单元自由度与全局自由度的对应关系。<br />
记单元节点 ID 为 <span class="arithmatex">\(\{I_1, I_2, \dots, I_n\}\)</span>，则在装配时有：</p>
<div class="arithmatex">\[
K(I_a, I_b) \;+=\; k^{(e)}_{ab}, 
\qquad 
R(I_a) \;+=\; f^{(e)}_{a}
\]</div>
<h3 id="32">3.2 全局矩阵与向量更新<a class="headerlink" href="#32" title="Permanent link">¶</a></h3>
<p>遍历所有单元，对其局部矩阵与向量依次累加到全局系统中：</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">element</span><span class="w"> </span><span class="n">e</span><span class="o">:</span>
<span class="w">    </span><span class="n">ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">element</span><span class="p">.</span><span class="n">node_ids</span><span class="p">()</span><span class="w">   </span><span class="c1">// 单元的全局节点编号</span>
<span class="w">    </span><span class="n">Ke</span><span class="p">,</span><span class="w"> </span><span class="n">Fe</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">compute_element_matrices</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">ids</span><span class="o">:</span>
<span class="w">        </span><span class="n">R</span><span class="p">[</span><span class="n">a</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">Fe</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">ids</span><span class="o">:</span>
<span class="w">            </span><span class="n">K</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="n">Ke</span><span class="p">[</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">]</span>
</code></pre></div>
<h2 id="4">4. 狄利克雷边界条件的施加<a class="headerlink" href="#4" title="Permanent link">¶</a></h2>
<div class="arithmatex">\[
u(x,y) = g(x,y), \quad (x,y) \in \Gamma_D
\]</div>
<p>其中 <span class="arithmatex">\(\Gamma_D\)</span> 表示狄利克雷边界，<span class="arithmatex">\(g(x,y)\)</span> 是给定的边界函数。</p>
<p>对于边界上的某个自由度 <span class="arithmatex">\(i\)</span>，其解值应满足：</p>
<div class="arithmatex">\[
u_i = g_i
\]</div>
<p>这意味着该自由度不再由方程系统求解，而是被直接约束。<br />
因此，需要在数值代数系统中“消除”该未知数的自由度。</p>
<hr />
<h3 id="41">4.1 修改全局矩阵和残差<a class="headerlink" href="#41" title="Permanent link">¶</a></h3>
<p>常用的狄利克雷边界条件施加方法是 <strong>修改全局矩阵和残差</strong>：</p>
<ol>
<li><strong>清零矩阵对应的行和列</strong>  </li>
</ol>
<p>对于边界自由度 <span class="arithmatex">\(i\)</span>，将全局雅可比矩阵的第 <span class="arithmatex">\(i\)</span> 行和第 <span class="arithmatex">\(i\)</span> 列清零，只在对角线上保留 1：</p>
<p>$$
   K(i,:) = 0, \quad K(:,i) = 0, \quad K(i,i) = 1
   $$
2. <strong>修改残差向量</strong>  </p>
<p>将残差向量对应位置改为：</p>
<p>$$
   R(i) = u(i) - g_i
   $$</p>
<p>其中 <span class="arithmatex">\(u(i)\)</span> 是当前迭代解，<span class="arithmatex">\(g_i\)</span> 是边界值。这样保证迭代过程中 <span class="arithmatex">\(u(i)\)</span> 始终收敛到边界函数。</p>
<h3 id="42">4.2 程序实现逻辑<a class="headerlink" href="#42" title="Permanent link">¶</a></h3>
<p>在代码中，狄利克雷边界条件的处理出现在<code>assembleForIteration</code> 中，逻辑如下：</p>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="w"> </span><span class="n">each</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="n">i</span><span class="o">:</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">node</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="n">在边界</span><span class="o">:</span>
<span class="w">        </span><span class="kt">double</span><span class="w"> </span><span class="n">ubc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">gD</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">);</span><span class="w">   </span><span class="c1">// 边界值 g(x,y)</span>
<span class="w">        </span><span class="c1">// 修改全局矩阵</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">nodes</span><span class="o">:</span>
<span class="w">            </span><span class="n">K</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">            </span><span class="n">K</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0</span><span class="p">;</span>
<span class="w">        </span><span class="n">K</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span>
<span class="w">        </span><span class="c1">// 修改残差向量</span>
<span class="w">        </span><span class="n">R</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">ubc</span><span class="p">;</span>
</code></pre></div>









  




                

  

              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            

  
    
  




  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
      
      
        
        
      
      <li class="task-list-item">
        <label class="task-list-control">
          <input type="checkbox" name="analytics" checked>
          <span class="task-list-indicator"></span>
          Google Analytics
        </label>
      </li>
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout(function(){document.querySelector("[data-md-component=consent]").hidden=!1},250);var action,form=document.forms.consent;for(action of["submit","reset"])form.addEventListener(action,function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map(function(e){return[e,!0]}))),location.hash="",location.reload()})</script>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>